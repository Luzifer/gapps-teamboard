<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/1.1.1/js/md5.min.js"></script>

<script type="text/jsx">

// tutorial1.js
var TeamList = React.createClass({

  getInitialState: function() {
    return {data: []};
  },

  componentDidMount: function() {

    var that = this;

    google.script.run
       .withSuccessHandler(function(teams) {
          that.setState({data: teams});
          })
       .getTeams();
  },

  render: function() {
  
    var teamNodes = this.state.data.map(function (team) {
      return (
        <Team key={team.name} {...team} />
      );
    });
    
    return (
      <div className="row">
        {teamNodes}
      </div>
    );
  }
});

var Team = React.createClass({
  render: function() {
    return (
      <div className="col-md-4">
      <div className="panel panel-default">
        <div className="panel-heading">{this.props.name}</div>
        <div className="panel-body team-properties">
          <dl className="dl-horizontal">
            <dt>Mission</dt>
            <dd>{this.props.mission}</dd>
            <dt>Vision</dt>
            <dd>{this.props.vision}</dd>
            <dt>Constraints</dt>
            <dd>{this.props.constraints}</dd>
            <dt>Office Floor</dt>
            <dd>{this.props.floor}</dd>
            <dt>Chat</dt>
            <dd>{this.props.chat}</dd>
            <dt>Ticket</dt>
            <dd>{this.props.ticket}</dd>
          </dl>
          <TeamMembers members={this.props.members}></TeamMembers>
        </div>
      </div>
      </div>
    );
  }
});

var TeamMembers = React.createClass({
  render: function() {
    var teamMemberNodes = this.props.members.map(function (member) {
      return (
        <TeamMember key={member.email} {...member} />
      );
    });
    
    return (
      <div>
      {teamMemberNodes}
      </div>
    );
  }
});

var TeamMember = React.createClass({
  render: function() {
    return (
       <a href={"mailto:" + this.props.email}><img alt={this.props.name} title={this.props.name} src={this.props.thumbnailPhotoUrl} /></a>
    );
  }
});

React.render(
  <TeamList />,
  document.getElementById('content')
);

</script>
